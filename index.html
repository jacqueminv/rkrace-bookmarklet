<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="google-site-verification" content="UwKGxpqrRZFVMqFaO1V0FKTvTjb0d-nwnEZwCIw3T_8" />
    <title>Rkrace-bookmarklet by jacqueminv</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <style>
      #bk {
        display: block;
        height: 3em;
        text-align: center;
        padding: 1.5em 0 0;
        margin: 0 0 1em;
        background-color: #eee;
        border-radius: 1em;
      }

      ins {
        text-decoration: none;
      }
    </style>
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>RKrace-bookmarklet</h1>
        <p>Edit a race map on Runkeeper simply by droping a gpx file.</p>

        <p class="view"><a href="https://github.com/jacqueminv/rkrace-bookmarklet">View the Project on GitHub <small>jacqueminv/rkrace-bookmarklet</small></a></p>

      </header>
      <section>
        <h3>Editing a race map, one click away</h3>

        <p>Being a fan of Runkeeper since a while I was annoyed by their race map creation workflow. You have to provide the race map and this is possible only by manually setting points. This can take minutes if not hours for some races and it can be hard to be precise (e.g. trail races anybody?).</p>

        <p>The little hacker deep inside me kept urging me to have a try fixing this. Here comes my bookmarklet.</p>

        <p>Drag and drop the following link in your bookmarks. Next time you want to edit a race on Runkeeper, simply click this bookmark and a small box asking you to provide a <code>gpx</code> file will appear. Drag and drop the race file and the process will start. This can take a while depending on your browser and available resources as everything is done in the browser. Nothing is sent or tracked from this bookmarklet. The code is open feel free to check.</p>

        <p>Note this was purposed for race maps at first but it actually works for any activity map found on Runkeeper.</p>

        <a id="bk" href="">
          rkrace-bookmarklet
        </a>

        <script>
          function bk(){javascript:(function(e){function a(e){e.stopPropagation();e.preventDefault();var n=e.dataTransfer.files,r,u,a,f,l=new FileReader;if(n.length!==1||n[0].size&&n[0].size>5242880){alert("Please give only one file (max size accepted: 5mb)");return}f=function(e){var t,n,r,i,s=0,o,u,a,f,l=0,c,h=0,p,d,v,m=[];t=function(){};t.constants={DOCTYPE_START:"<!DOCTYPE",CDATA_START:"<![CDATA[",CDATA_END:"]]>",COMMENT_START:"<!--",COMMENT_END:"-->",TAG_OPEN:"<",TAG_CLOSE:">",TAG_CLOSE_SELF_TERMINATING:"/>",ENDTAG_OPEN:"</",EQUALS:"=",SQUOTE:"'",DQUOTE:'"',PI_START:"<?",PI_END:"?>",BRACKET_OPEN:"[",BRACKET_CLOSE:"]",TOKENTYPE_BRACKET_OPEN:"bracketOpen",TOKENTYPE_TAG_OPEN:"tagOpen",TOKENTYPE_TAG_CLOSE:"tagClose",TOKENTYPE_ENDTAG_OPEN:"endTagOpen",TOKENTYPE_ENDTAG_CLOSE:"endTagClose",TOKENTYPE_SELF_TERMINATING:"closeTagSelfTerminating",TOKENTYPE_WHITESPACE:"whitespace",TOKENTYPE_ATTRIBUTE:"attribute",TOKENTYPE_QUOTE:"quote",TOKENTYPE_QUOTED:"quotedLiteral",TOKENTYPE_NORMAL:"normal",TOKENTYPE_COMMENT_START:"commentStart",TOKENTYPE_COMMENT_END:"commentEnd",TOKENTYPE_CDATA_START:"cdataStart",TOKENTYPE_CDATA_END:"cdataEnd",TOKENTYPE_PI_START:"piStart",TOKENTYPE_PI_END:"piEnd",TOKENTYPE_DOCTYPE_START:"docTypeStart",DATATYPE_ATTRIBUTE:"marknote.Attribute",DATATYPE_CDATA:"marknote.CDATA",DATATYPE_CLONER:"marknote.Cloner",DATATYPE_COMMENT:"marknote.Comment",DATATYPE_DOCTYPE:"marknote.DOCTYPE",DATATYPE_DOCUMENT:"marknote.Document",DATATYPE_ELEMENT:"marknote.Element",DATATYPE_ENTITYREF:"marknote.EntityRef",DATATYPE_XMLENTITYREFS:"marknote.XMLEntityRefs",DATATYPE_ENTITYREFS:"marknote.EntityRefs",DATATYPE_PARSER:"marknote.Parser",DATATYPE_PROCESSINGINSTRUCTION:"marknote.ProcessingInstruction",DATATYPE_QNAME:"marknote.QName",DATATYPE_TEXT:"marknote.Text",DATATYPE_TOKEN:"marknote.Token",DATATYPE_TOKENIZER:"marknote.Tokenizer",DATATYPE_WRITER:"marknote.Writer"};t.ajaxDoc=null;t.AJAX=function(){this.req=null;this.status=null;this.statusText=null;this.responseText=null};t.AJAX.prototype.genRequest=function(){var e=false;try{e=new XMLHttpRequest}catch(t){try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(n){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(r){e=false}}}this.req=e;return e};t.AJAX.prototype.getRequest=function(){return this.req};t.AJAX.prototype.getStatus=function(){return this.status};t.AJAX.prototype.getStatusText=function(){return this.statusText};t.AJAX.prototype.getResponseText=function(){return this.responseText};t.AJAX.prototype.constructQueryString=function(e){var t="";if(e&&typeof e=="object"){var n="";for(var r in e){t+=n+encodeURIComponent(r)+"="+encodeURIComponent(e[r]);n="&"}}else{if(e&&typeof e=="string"){t=e}}return t};t.AJAX.prototype.read=function(e,n,r,i,s){var o=this.genRequest();var u=this;var a=this.constructQueryString(n);var f;t.AJAXDoc=null;s=s&&s.toUpperCase()==="POST"?"POST":"GET";if(!o){return false}if(!r){r=t.AJAX.defaultCallback}if(!i){i=new Object}o.open(s,e,true);o.setRequestHeader("Content-Type","application/x-www-form-urlencoded");o.onreadystatechange=function(){if(o.readyState==4){u.status=o.status;u.statusText=o.statusText;u.responseText=o.responseText;var e=new t.Parser;f=e.parse(o.responseText);r.call(u,f,i)}};o.send(a)};t.AJAX.prototype.defaultCallback=function(e,n){t.AJAXDoc=e};t.SJAX=function(){this.req=null;this.status=null;this.statusText=null;this.responseText=null};t.SJAX.prototype.getRequest=function(){return this.req};t.SJAX.prototype.getStatus=function(){return this.status};t.SJAX.prototype.getStatusText=function(){return this.statusText};t.SJAX.prototype.getResponseText=function(){return this.responseText};t.SJAX.prototype.read=function(e,n,r){var i=new t.AJAX;var s=i.genRequest();var o=i.constructQueryString(n);var u=new t.Parser;r=r&&r.toUpperCase()==="POST"?"POST":"GET";if(!s){return new t.Document}s.open(r,e,false);s.setRequestHeader("Content-Type","application/x-www-form-urlencoded");s.send(o);this.req=s;this.status=s.status;this.statusText=s.statusText;this.responseText=s.responseText;return u.parse(s.responseText)};t.Attribute=function(e,n){this.dataType=t.constants.DATATYPE_ATTRIBUTE;this.isSw8tXmlContent=false;this.name=e;this.value=t.Util.erefEncode(t.Util.nothingToBlank(n))};t.Attribute.prototype.getName=function(){return this.name};t.Attribute.prototype.setName=function(e){this.name=e};t.Attribute.prototype.getValue=function(){return t.Util.erefDecode(t.Util.nothingToBlank(this.value))};t.Attribute.prototype.setValue=function(e){this.value=t.Util.erefEncode(t.Util.nothingToBlank(e))};t.Attribute.prototype.toString=function(){return this.getName()+'="'+this.getValue()+'"'};t.Attribute.prototype.clone=function(){return new t.Attribute(this.getName(),this.getValue())};t.CDATA=function(e){this.dataType=t.constants.DATATYPE_CDATA;this.isSw8tXmlContent=true;this.text=t.Util.nothingToBlank(e)};t.CDATA.prototype.getText=function(){return t.Util.nothingToBlank(this.text)};t.CDATA.prototype.setText=function(e){this.text=t.Util.nothingToBlank(e)};t.CDATA.prototype.toString=function(){return this.getText()};t.CDATA.prototype.clone=function(){var e=new t.Cloner;return e.clone(this)};t.Cloner=function(){this.dataType=t.constants.DATATYPE_CLONER;this.isSw8tXmlContent=false};t.Cloner.prototype.cloneDocument=function(e){var n=new t.Document;var r=e.getProcessingInstructions();var i=e.getRootElement();var s;for(var o=0;o<r.length;o++){s=this.cloneProcessingInstruction(r[o]);n.addProcessingInstruction(s)}var u=this.cloneElement(i);n.setRootElement(u);return n};t.Cloner.prototype.cloneProcessingInstruction=function(e){var n=e.getData();var r=e.getTarget().slice(0);var i=this.cloneArray(n);return new t.ProcessingInstruction(r,i)};t.Cloner.prototype.cloneElement=function(e){var n=new t.Element;var r=e.getName().slice(0);var i=this.cloneArray(e.getAttributes());n.setName(r);n.setAttributes(i);if(e.isSelfTerminated){n.isSelfTerminated=true;return n}var s=this.cloneContents(e);n.setContents(s);return n};t.Cloner.prototype.cloneContents=function(e){var n=new Array;var r,i;for(var s=0;s<e.getContents().length;s++){var o=e.getContentAt(s);i=t.Util.dataType(o);switch(i){case t.constants.DATATYPE_ELEMENT:r=this.cloneElement(o);n.push(r);break;default:r=this.clone(o);n.push(r);break}}return n};t.Cloner.prototype.clone=function(e){var t=e.dataType&&e.dataType.indexOf("marknote.")>0||typeof e=="object";if(!t){return e}var n=new Object;for(var r in e){n[r]=this.clone(e[r])}return n};t.Cloner.prototype.cloneArray=function(e){var t=new Array;var n;for(var r=0;r<e.length;r++){n=this.clone(e[r]);t.push(n)}return t};t.Comment=function(e){this.dataType=t.constants.DATATYPE_COMMENT;this.isSw8tXmlContent=true;this.text=t.Util.erefEncode(t.Util.nothingToBlank(e))};t.Comment.prototype.getText=function(){return t.Util.erefDecode(t.Util.nothingToBlank(this.text))};t.Comment.prototype.setText=function(e){this.text=t.Util.erefEncode(t.Util.nothingToBlank(e))};t.Comment.prototype.toString=function(){return this.getText()};t.Comment.prototype.clone=function(){var e=new t.Cloner;return e.clone(this)};t.FPI=function(e,t,n,r,i){this.registration=e;this.organization=t;this.publicTextClass=n;this.publicTextDescription=r;this.publicTextLanguage=i};t.FPI.prototype.toString=function(){return'"'+this.getRegistration()+"//"+this.getOrganization()+"//"+this.getPublicTextClass()+" "+this.getPublicTextDescription()+"//"+this.getPublicTextLanguage()+'"'};t.FPI.prototype.getRegistration=function(){return this.registration};t.FPI.prototype.setRegistration=function(e){this.registration=e};t.FPI.prototype.getOrganization=function(){return this.organization};t.FPI.prototype.setOrganization=function(e){this.organziation=e};t.FPI.prototype.getPublicTextClass=function(){return this.publicTextClass};t.FPI.prototype.setPublicTextClass=function(e){this.publicTextClass=e};t.FPI.prototype.getPublicTextDescription=function(){return this.publicTextDescription};t.FPI.prototype.setPublicTextDescription=function(e){this.publicTextDescription=e};t.FPI.prototype.getPublicTextLanguage=function(){return this.publicTextLanguage};t.FPI.prototype.setPublicTextLanguage=function(e){this.publicTextLanguage=e};t.DOCTYPE=function(e,n,r,i,s){this.dataType=t.constants.DATATYPE_DOCTYPE;this.isSw8tXmlContent=false;if(e&&!n){var o=new String(e);var u=new t.Parser;var a=u.parseDOCTYPE(o);this.topElement=a.getTopElement();this.availability=a.getAvailability();this.FPI=a.getFPI();this.URL=a.getURL();this.internalSubset=a.getInternalSubset()}else{this.setTopElement(e);this.setAvailability(n);this.setFPI(r);this.setURL(i);this.setInternalSubset(s)}};t.DOCTYPE.prototype.toString=function(){var e=this.getAvailability()=="PUBLIC"&&this.getFPI()?" "+this.getFPI():"";var t=this.getURL()?" "+this.getURL():"";var n=this.getInternalSubset()?" "+this.getInternalSubset():"";return"<!DOCTYPE "+this.getTopElement()+" "+this.getAvailability()+e+t+n+">"};t.DOCTYPE.prototype.getTopElement=function(){return this.topElement};t.DOCTYPE.prototype.setTopElement=function(e){this.topElement=e};t.DOCTYPE.prototype.getAvailability=function(){return this.availability};t.DOCTYPE.prototype.setAvailability=function(e){this.availability=e};t.DOCTYPE.prototype.getFPI=function(){return this.FPI};t.DOCTYPE.prototype.setFPI=function(e){this.FPI=e};t.DOCTYPE.prototype.getURL=function(){return this.URL};t.DOCTYPE.prototype.setURL=function(e){var n=t.Util.trim(e);if(n===""){this.URL="";return}if(n.charAt(0)!='"'){n='"'+n}if(n.charAt(n.length-1)!='"'){n+='"'}this.URL=n};t.DOCTYPE.prototype.getInternalSubset=function(){return this.internalSubset};t.DOCTYPE.prototype.setInternalSubset=function(e){this.dataType=t.constants.DATATYPE_DOCTYPE;this.internalSubset=e};t.Document=function(){this.dataType=t.constants.DATATYPE_DOCUMENT;this.isSw8tXmlContent=false;this.processingInstructions=new Array;this.rootElement=new t.Element;this.contents=new Array};t.Document.prototype.getProcessingInstructions=function(){return this.processingInstructions};t.Document.prototype.setProcessingInstructions=function(e){this.processingInstructions=e};t.Document.prototype.addProcessingInstruction=function(e){this.processingInstructions.push(e)};t.Document.prototype.removeProcessingInstruction=function(e){for(var n=0;n<this.processingInstructions.length;n++){var r=this.processingInstructions[n].getTarget();if(r==e){t.Util.removeArrayItem(this.processingInstructions,n)}}};t.Document.prototype.getRootElement=function(){return this.rootElement};t.Document.prototype.setRootElement=function(e){if(!(e instanceof t.Element)){return}this.rootElement=e};t.Document.prototype.getDOCTYPE=function(){return this.DOCTYPE};t.Document.prototype.setDOCTYPE=function(e){this.DOCTYPE=e};t.Document.prototype.getBaseURI=function(){return this.baseURI};t.Document.prototype.setBaseURI=function(e){this.baseURI=e};t.Document.prototype.toString=function(e,n,r,i){var s=new t.Writer;return s.outputDocument(this,e)};t.Document.prototype.clone=function(){var e=new t.Cloner;return e.cloneDocument(this)};t.Element=function(e){this.dataType=t.constants.DATATYPE_ELEMENT;this.isSw8tXmlContent=true;this.contents=new Array;this.attributes=new Array;this.qname=new t.QName;this.isSelfTerminated=false;if(e){if(e instanceof t.QName){this.setQName(e)}else{this.setName(e)}}};t.Element.prototype.getName=function(){return this.qname.getName()};t.Element.prototype.setName=function(e){this.qname.setName(e)};t.Element.prototype.getQName=function(){return this.qname};t.Element.prototype.setQName=function(e){this.qname=e};t.Element.prototype.hasContents=function(){return this.contents&&this.contents.length>0};t.Element.prototype.getContents=function(){return this.contents};t.Element.prototype.getContentAt=function(e){return this.getContents()[e]};t.Element.prototype.addContent=function(e){if(e&&e.isSw8tXmlContent){this.getContents().push(e)}};t.Element.prototype.removeContent=function(e){t.Util.removeArrayItem(this.contents,e)};t.Element.prototype.setContents=function(e){this.contents=e};t.Element.prototype.getText=function(e){var n="";if(typeof e=="undefined"){e=true}for(var r=0;r<this.contents.length;r++){var i=this.getContentAt(r);var s=t.Util.dataType(i);if(s==t.constants.DATATYPE_TEXT){n+=i.getText(e)}else{if(s==t.constants.DATATYPE_CDATA){n+=i.getText()}}}return n};t.Element.prototype.setText=function(e){var n=new Array;for(var r=0;r<this.contents.length;r++){var i=this.getContentAt(r);var s=t.Util.dataType(i);if(s==t.constants.DATATYPE_COMMENT){n.push(i)}}this.contents=n;e=e?""+e:"";this.contents.push(new t.Text(e))};t.Element.prototype.setCDATAText=function(e){var n=new Array;for(var r=0;r<this.contents.length;r++){var i=this.getContentAt(r);var s=t.Util.dataType(i);if(s==t.constants.DATATYPE_COMMENT){n.push(i)}}this.contents=n;e=e?""+e:"";this.contents.push(new t.CDATA(e))};t.Element.prototype.removeText=function(){for(var e=this.contents.length-1;e>=0;e--){var n=this.getContentAt(e);var r=t.Util.dataType(n);if(r==t.constants.DATATYPE_TEXT||r==t.constants.DATATYPE_CDATA){t.Util.removeArrayItem(this.contents,e)}}};t.Element.prototype.getCommentText=function(){var e="";for(var n=0;n<this.contents.length;n++){var r=this.getContentAt(n);var i=t.Util.dataType(r);if(i==t.constants.DATATYPE_COMMENT){e+=r.getText()}}return e};t.Element.prototype.setCommentText=function(e){this.removeComments();e=e?""+e:"";this.addContent(new t.Comment(e))};t.Element.prototype.removeComments=function(){for(var e=this.contents.length-1;e>=0;e--){var n=this.getContentAt(e);var r=t.Util.dataType(n);if(r==t.constants.DATATYPE_COMMENT){t.Util.removeArrayItem(this.contents,e)}}};t.Element.prototype.addChildElement=function(e){var n=t.Util.dataType(e);if(!n==t.constants.DATATYPE_ELEMENT){return}this.getContents().push(e)};t.Element.prototype.removeChildElements=function(e){var n=0;if(!e){n=this.contents.length;this.contents=new Array;return n}var r=e.dataType==t.constants.DATATYPE_QNAME?e.getName():e;var i=t.Cloner.cloneArray(this.contents);for(var s=i.length-1;s>=0;s--){var o=t.Util.dataType(i[s]);if(o!=t.constants.DATATYPE_ELEMENT){continue}if(this.clonedContents[s].getName()==r){t.Util.removeArrayItem(this.contents,s);n++}}return n};t.Element.prototype.getChildElements=function(e){var n=false;var r=new Array;if(e){n=e.dataType==t.constants.DATATYPE_QNAME?e.getName():e}for(var i=0;i<this.contents.length;i++){var s=this.contents[i];var o=t.Util.dataType(s);if(o!=t.constants.DATATYPE_ELEMENT){continue}if(n){if(s.getName()==n){r.push(s)}}else{r.push(s)}}return r};t.Element.prototype.getChildElement=function(e){var n=e.dataType==t.constants.DATATYPE_QNAME?e.getName():e;if(n){var r=this.getContents();for(var i=0;i<r.length;i++){var s=r[i];var o=t.Util.dataType(s);if(o==t.constants.DATATYPE_ELEMENT){var u=s.getName();if(u===n){return s}}}}};t.Element.prototype.removeChildElement=function(e){var n=e.dataType==t.constants.DATATYPE_QNAME?e.getName():e;if(n){var r=this.getContents();for(var i=0;i<r.length;i++){var s=r[i];var o=t.Util.dataType(s);if(o==t.constants.DATATYPE_ELEMENT){var u=s.getName();if(u===n){t.Util.removeArrayItem(this.contents,i);return}}}}};t.Element.prototype.getChildElementAt=function(e){try{return this.getChildElements()[e]}catch(t){}};t.Element.prototype.removeChildElementAt=function(e){var n=-1;var r;for(var i=0;i<this.contents.length;i++){r=t.Util.dataType(this.contents[i])==t.constants.DATATYPE_ELEMENT;if(r){n++;if(e==n){t.Util.removeArrayItem(this.contents,i);return}}}};t.Element.prototype.getAttributes=function(){return this.attributes};t.Element.prototype.setAttributes=function(e){this.attributes=e};t.Element.prototype.getAttribute=function(e){for(var t=0;t<this.getAttributes().length;t++){var n=this.getAttributes()[t];if(n.getName()==e){return n}}};t.Element.prototype.getAttributeValue=function(e){var t=this.getAttribute(e);return t?t.getValue():""};t.Element.prototype.getAttributeAt=function(e){return this.getAttributes()[e]};t.Element.prototype.setAttribute=function(e,n){if(t.Util.dataType(e)==t.constants.DATATYPE_ATTRIBUTE){this.putAttribute(e)}else{for(var r=0;r<this.getAttributes().length;r++){var i=this.getAttributes()[r];if(i.getName()==e){i.setValue(n);return}}this.putAttribute(new t.Attribute(e,n))}};t.Element.prototype.putAttribute=function(e){if(e&&this.getAttribute(e.getName())){this.removeAttribute(e.getName())}this.getAttributes().push(e)};t.Element.prototype.removeAttribute=function(e){var t=new Array;for(var n=0;n<this.getAttributes().length;n++){var r=this.getAttributes()[n];if(r.getName()!=e){t.push(r)}}this.setAttributes(t)};t.Element.prototype.removeAllAttributes=function(){this.setAttributes(new Array)};t.Element.prototype.toString=function(e){var n=new t.Writer;return n.outputElement(this,0,e)};t.Element.prototype.clone=function(){var e=new t.Cloner;return e.cloneElement(this)};t.EntityRef=function(e,n){this.dataType=t.constants.DATATYPE_ENTITYREF;this.name=e;this.character=n};t.EntityRef.prototype.getName=function(){return this.name};t.EntityRef.prototype.setName=function(e){this.name=e};t.EntityRef.prototype.getName=function(){return this.name};t.EntityRef.prototype.setName=function(e){this.dataType=t.constants.DATATYPE_ENTITYREF;this.isSw8tXmlContent=false;this.character=e};t.EntityRef.prototype.clone=function(){var e=new t.Cloner;return e.clone(this)};t.XMLEntityRefs=function(){this.dataType=t.constants.DATATYPE_XMLENTITYREFS;this.isSw8tXmlContent=false;this.refs=new Array;this.pushRef("quot",34);this.pushRef("amp",38);this.pushRef("apos",39);this.pushRef("lt",60);this.pushRef("gt",62)};t.XMLEntityRefs.prototype.getRefs=function(){return this.refs};t.XMLEntityRefs.prototype.pushRef=function(e,n){this.refs.push(new t.EntityRef(e,String.fromCharCode(n)))};t.EntityRefs=function(){this.dataType=t.constants.DATATYPE_ENTITYREFS;this.isSw8tXmlContent=false;this.refs=(new Array).concat((new t.XMLEntityRefs).getRefs());this.pushRef("nbsp",160);this.pushRef("iexcl",161);this.pushRef("cent",162);this.pushRef("pound",163);this.pushRef("curren",164);this.pushRef("yen",165);this.pushRef("brvbar",166);this.pushRef("sect",167);this.pushRef("uml",168);this.pushRef("copy",169);this.pushRef("ordf",170);this.pushRef("laquo",171);this.pushRef("not",172);this.pushRef("shy",173);this.pushRef("reg",174);this.pushRef("macr",175);this.pushRef("deg",176);this.pushRef("plusmn",177);this.pushRef("sup2",178);this.pushRef("sup3",179);this.pushRef("acute",180);this.pushRef("micro",181);this.pushRef("para",182);this.pushRef("middot",183);this.pushRef("cedil",184);this.pushRef("sup1",185);this.pushRef("ordm",186);this.pushRef("raquo",187);this.pushRef("frac14",188);this.pushRef("frac12",189);this.pushRef("frac34",190);this.pushRef("iquest",191);this.pushRef("Agrave",192);this.pushRef("Aacute",193);this.pushRef("Acirc",194);this.pushRef("Atilde",195);this.pushRef("Auml",196);this.pushRef("Aring",197);this.pushRef("AElig",198);this.pushRef("Ccedil",199);this.pushRef("Egrave",200);this.pushRef("Eacute",201);this.pushRef("Ecirc",202);this.pushRef("Euml",203);this.pushRef("Igrave",204);this.pushRef("Iacute",205);this.pushRef("Icirc",206);this.pushRef("Iuml",207);this.pushRef("ETH",208);this.pushRef("Ntilde",209);this.pushRef("Ograve",210);this.pushRef("Oacute",211);this.pushRef("Ocirc",212);this.pushRef("Otilde",213);this.pushRef("Ouml",214);this.pushRef("times",215);this.pushRef("Oslash",216);this.pushRef("Ugrave",217);this.pushRef("Uacute",218);this.pushRef("Ucirc",219);this.pushRef("Uuml",220);this.pushRef("Yacute",221);this.pushRef("THORN",222);this.pushRef("szlig",223);this.pushRef("agrave",224);this.pushRef("aacute",225);this.pushRef("acirc",226);this.pushRef("atilde",227);this.pushRef("auml",228);this.pushRef("aring",229);this.pushRef("aelig",230);this.pushRef("ccedil",231);this.pushRef("egrave",232);this.pushRef("eacute",233);this.pushRef("ecirc",234);this.pushRef("euml",235);this.pushRef("igrave",236);this.pushRef("iacute",237);this.pushRef("icirc",238);this.pushRef("iuml",239);this.pushRef("eth",240);this.pushRef("ntilde",241);this.pushRef("ograve",242);this.pushRef("oacute",243);this.pushRef("ocirc",244);this.pushRef("otilde",245);this.pushRef("ouml",246);this.pushRef("divide",247);this.pushRef("oslash",248);this.pushRef("ugrave",249);this.pushRef("uacute",250);this.pushRef("ucirc",251);this.pushRef("uuml",252);this.pushRef("yacute",253);this.pushRef("thorn",254);this.pushRef("yuml",255);this.pushRef("OElig",338);this.pushRef("oelig",339);this.pushRef("Scaron",352);this.pushRef("scaron",353);this.pushRef("Yuml",376);this.pushRef("fnof",402);this.pushRef("circ",710);this.pushRef("tilde",732);this.pushRef("Alpha",913);this.pushRef("Beta",914);this.pushRef("Gamma",915);this.pushRef("Delta",916);this.pushRef("Epsilon",917);this.pushRef("Zeta",918);this.pushRef("Eta",919);this.pushRef("Theta",920);this.pushRef("Iota",921);this.pushRef("Kappa",922);this.pushRef("Lambda",923);this.pushRef("Mu",924);this.pushRef("Nu",925);this.pushRef("Xi",926);this.pushRef("Omicron",927);this.pushRef("Pi",928);this.pushRef("Rho",929);this.pushRef("Sigma",931);this.pushRef("Tau",932);this.pushRef("Upsilon",933);this.pushRef("Phi",934);this.pushRef("Chi",935);this.pushRef("Psi",936);this.pushRef("Omega",937);this.pushRef("alpha",945);this.pushRef("beta",946);this.pushRef("gamma",947);this.pushRef("delta",948);this.pushRef("epsilon",949);this.pushRef("zeta",950);this.pushRef("eta",951);this.pushRef("theta",952);this.pushRef("iota",953);this.pushRef("kappa",954);this.pushRef("lambda",955);this.pushRef("mu",956);this.pushRef("nu",957);this.pushRef("xi",958);this.pushRef("omicron",959);this.pushRef("pi",960);this.pushRef("rho",961);this.pushRef("sigmaf",962);this.pushRef("sigma",963);this.pushRef("tau",964);this.pushRef("upsilon",965);this.pushRef("phi",966);this.pushRef("chi",967);this.pushRef("psi",968);this.pushRef("omega",969);this.pushRef("thetasym",977);this.pushRef("upish",978);this.pushRef("piv",982);this.pushRef("ensp",8194);this.pushRef("emsp",8195);this.pushRef("thinsp",8201);this.pushRef("zwnj",8204);this.pushRef("zwj",8205);this.pushRef("lrm",8206);this.pushRef("rlm",8207);this.pushRef("ndash",8211);this.pushRef("mdash",8212);this.pushRef("lsquo",8216);this.pushRef("rsquo",8217);this.pushRef("sbquo",8218);this.pushRef("ldquo",8220);this.pushRef("rdquo",8221);this.pushRef("bdquo",8222);this.pushRef("dagger",8224);this.pushRef("Dagger",8225);this.pushRef("bull",8226);this.pushRef("hellip",8230);this.pushRef("permil",8240);this.pushRef("prime",8242);this.pushRef("Prime",8243);this.pushRef("lsaquo",8249);this.pushRef("rsaquo",8250);this.pushRef("oline",8254);this.pushRef("frasl",8260);this.pushRef("euro",8364);this.pushRef("image",8465);this.pushRef("weierp",8472);this.pushRef("real",8476);this.pushRef("trade",8482);this.pushRef("alefsym",8501);this.pushRef("larr",8592);this.pushRef("uarr",8593);this.pushRef("rarr",8594);this.pushRef("darr",8595);this.pushRef("harr",8596);this.pushRef("crarr",8629);this.pushRef("lArr",8656);this.pushRef("uArr",8657);this.pushRef("rArr",8658);this.pushRef("dArr",8659);this.pushRef("hArr",8660);this.pushRef("forall",8704);this.pushRef("part",8706);this.pushRef("exist",8707);this.pushRef("empty",8709);this.pushRef("nabla",8711);this.pushRef("isin",8712);this.pushRef("notin",8713);this.pushRef("ni",8715);this.pushRef("prod",8719);this.pushRef("sum",8721);this.pushRef("minus",8722);this.pushRef("lowast",8727);this.pushRef("radic",8730);this.pushRef("prop",8733);this.pushRef("infin",8734);this.pushRef("ang",8736);this.pushRef("and",8743);this.pushRef("or",8744);this.pushRef("cap",8745);this.pushRef("cup",8746);this.pushRef("int",8747);this.pushRef("there4",8756);this.pushRef("sim",8764);this.pushRef("cong",8773);this.pushRef("asymp",8776);this.pushRef("ne",8800);this.pushRef("equiv",8801);this.pushRef("le",8804);this.pushRef("ge",8805);this.pushRef("sub",8834);this.pushRef("sup",8835);this.pushRef("nsub",8836);this.pushRef("sube",8838);this.pushRef("supe",8839);this.pushRef("oplus",8853);this.pushRef("otimes",8855);this.pushRef("perp",8869);this.pushRef("sdot",8901);this.pushRef("lceil",8968);this.pushRef("rceil",8969);this.pushRef("lfloor",8970);this.pushRef("rfloor",8971);this.pushRef("lang",9001);this.pushRef("rang",9002);this.pushRef("loz",9674);this.pushRef("spades",9824);this.pushRef("clubs",9827);this.pushRef("hearts",9829);this.pushRef("diams",9830)};t.EntityRefs.prototype.getRefs=function(){return this.refs};t.EntityRefs.prototype.pushRef=function(e,n){this.refs.push(new t.EntityRef(e,String.fromCharCode(n)))};t.Parser=function(){this.dataType=t.constants.DATATYPE_PARSER;this.isSw8tXmlContent=false;this.doc=new t.Document;this.status=0;this.statusMessage="success";this.xhr=null;this.xhrStatus=null;this.xhrStatusText=null;this.xhrResponseText=null};t.Parser.prototype.getDocument=function(){return this.doc};t.Parser.prototype.getXHR=function(){return this.xhr};t.Parser.prototype.getXHRStatus=function(){return this.xhrStatus};t.Parser.prototype.getXHRStatusText=function(){return this.xhrStatusText};t.Parser.prototype.getXHRResponseText=function(){return this.xhrResponseText};t.Parser.prototype.getStatus=function(){return this.status};t.Parser.prototype.setStatus=function(e){this.status=e};t.Parser.prototype.getStatusMessage=function(){return this.statusMessage};t.Parser.prototype.setStatusMessage=function(e){this.statusMessage=e};t.Parser.prototype.parseProcessingInstructions=function(e,n){var r=new t.Tokenizer(e);var i=r.tokenize();var s=0,o=0;var u=false;var a,f,l,c,h,p,d;for(var v=0;v<i.length;v++){d=i[v].getType();switch(d){case t.constants.TOKENTYPE_PI_START:s=i[v].getPosition();f="";l=new Array;u=true;f=i[v+1].getContent();v++;break;case t.constants.TOKENTYPE_PI_END:if(u){if(t.Util.isUndefinedNullOrBlank(f)){f="xml"}}u=false;o=i[v].getPosition()+2;a=new t.ProcessingInstruction(f,l);n.addProcessingInstruction(a);break;case t.constants.TOKENTYPE_ATTRIBUTE:if(u){h=i[v-1].getContent();p=i[v+1].getContent();p=p.slice(1,p.length-1);c=new t.Attribute(h,p);l.push(c)}v++;break;default:break}}if(o>s){var m=s>0?e.slice(0,s):"";var g=e.slice(o+1);return t.Util.trim(m+g)}else{return e}};t.Parser.prototype.parseProcessingInstructions=function(e,n){var r=new t.Tokenizer(e);var i=r.tokenize();var s=0,o=0;var u=false;var a,f,l,c,h,p,d;for(var v=0;v<i.length;v++){d=i[v].getType();switch(d){case t.constants.TOKENTYPE_PI_START:s=i[v].getPosition();f="";l=new Array;u=true;f=i[v+1].getContent();v++;break;case t.constants.TOKENTYPE_PI_END:if(u){if(t.Util.isUndefinedNullOrBlank(f)){f="xml"}}u=false;o=i[v].getPosition()+2;a=new t.ProcessingInstruction(f,l);n.addProcessingInstruction(a);break;case t.constants.TOKENTYPE_ATTRIBUTE:if(u){h=i[v-1].getContent();p=i[v+1].getContent();p=p.slice(1,p.length-1);c=new t.Attribute(h,p);l.push(c)}v++;break;default:break}}if(o>s){var m=s>0?e.slice(0,s):"";var g=e.slice(o+1);return t.Util.trim(m+g)}else{return e}};t.Parser.prototype.parseDOCTYPE=function(e,n){var r=new t.Tokenizer(e);var i=r.tokenize();var s=new t.DOCTYPE;var o,u;try{for(var a=0;a<i.length;a++){o=i[a].getType();switch(o){case t.constants.TOKENTYPE_DOCTYPE_START:if(n){n.setDOCTYPE(s)}if(i[++a].isTagClose()){return s}s.setTopElement(i[a].getContent());u=i[++a].getContent().toUpperCase();s.setAvailability(u);if("SYSTEM"==u){if(i[++a].isTagClose()){return s}s.setURL(i[a].getContent())}else{if("PUBLIC"==u){if(i[++a].isTagClose()){return s}s.setFPI(i[a].getContent());if(i[++a].isTagClose()){return s}s.setURL(i[a].getContent());if(i[++a].isTagClose()){return s}s.setInternalSubset(i[a].getContent())}}break;case t.constants.TOKENTYPE_TAG_CLOSE:return s;default:break}}}catch(f){window.alert(f)}return s};t.Parser.prototype.parse=function(e){this.xhr=null;this.xhrStatus=null;this.xhrStatusText=null;this.xhrResponseText=null;this.doc=new t.Document;this.setStatus(0);e=this.parseProcessingInstructions(e,this.doc);this.parseDOCTYPE(e,this.doc);this.parseElement(e,this.doc);return this.doc};t.Parser.prototype.parseURL=function(e,n,r){var i=new t.SJAX;var s=i.read(e,n,r);this.xhr=i.getRequest();this.xhrStatus=i.getStatus();this.xhrStatusText=i.getStatusText();this.xhrResponseText=i.getResponseText();return s};t.Parser.prototype.parseComment=function(e,n,r){var i=n[r+1].content==t.constants.COMMENT_START?"":n[r+1].content;var s=new t.Comment(i);if(e){e.addContent(s)}r=n[r+1].content==t.constants.COMMENT_START?r+1:r+2;return r};t.Parser.prototype.parseElement=function(e,n,r){var i=new t.Tokenizer(e);var s=i.tokenize();var o=0,u=0;var a=false;for(var f=0;f<s.length;f++){if(s[f].isCommentStart()){f=this.parseComment(r,s,f);continue}for(;f<s.length;f++){if(s[f].isTagOpen()){o=f;break}}if(o!=f){return}var l=new t.Element(s[o+1].content);if(!r){n.setRootElement(l)}else{r.addContent(l)}for(f=o+1;f<s.length;f++){switch(s[f].getType()){case t.constants.TOKENTYPE_SELF_TERMINATING:l.isSelfTerminated=true;o=f;break;case t.constants.TOKENTYPE_TAG_CLOSE:l.isSelfTerminated=false;o=f;break;case t.constants.TOKENTYPE_ATTRIBUTE:try{var c=s[f-1].content;var h=s[f+1].content;var p=h.slice(1,h.length-1);var d=new t.Attribute(c,p);l.putAttribute(d)}catch(v){}break;default:break}if(o==f){break}}if(!o==f){return}switch(s[o].content){case t.constants.TAG_CLOSE_SELF_TERMINATING:a=s[o+1]&&s[o+1].content==t.constants.COMMENT_START;if(a){u=o+1;while(a){u=this.parseComment(r,s,u);a=s[u+1]&&s[u+1].content==t.constants.COMMENT_START;if(a){u++}}}else{u=o}break;case t.constants.TAG_CLOSE:if(s[o+1]){if(s[o+1].isCDATAStart()){var m=s[f+2].content;var g=f+3;if(s[f+2].isCDATAEnd()){m="";g=f+2}var y=new t.CDATA(m);l.addContent(y);o=g}else{if(s[o+1].isLiteral){l.setText(s[o+1].getContent())}}}else{u=o}for(f=o+1;f<s.length;f++){var b=s[f].getContent()==t.constants.ENDTAG_OPEN&&s[f+1].getContent()==l.getName()?true:false;if(b){u=f;a=s[u+3]&&s[u+3].content==t.constants.COMMENT_START;if(a){u=this.parseComment(r,s,u+3)}var w=u==o+1||s[o+1].isLiteral&&u==o+2?false:true;if(!w){break}var E=s[o+1].getPosition();var S=s[u].getPosition();var x=e.slice(E,S);this.parseElement(x,n,l);break}}if(!b){return}break;default:return}f=u}};t.ProcessingInstruction=function(e,n){this.dataType=t.constants.DATATYPE_PROCESSINGINSTRUCTION;this.isSw8tXmlContent=false;this.target=e?e:"xml";if(e&&!n){this.data=new Array}else{if(!n){this.data=[new t.Attribute("version","1.0"),new t.Attribute("encoding","UTF-8")]}else{this.data=n}}};t.ProcessingInstruction.prototype.getData=function(){return this.data};t.ProcessingInstruction.prototype.setData=function(e){this.data=e};t.ProcessingInstruction.prototype.getTarget=function(){return this.target};t.ProcessingInstruction.prototype.setTarget=function(e){this.target=e};t.ProcessingInstruction.prototype.setAttribute=function(e){var n=this.getData();if(t.Util.dataType(e)==t.constants.DATATYPE_ATTRIBUTE){for(var r=0;r<n.length;r++){if(n[r].getName()==e.getName()){n[r].setValue(e.getValue());return}}}};t.ProcessingInstruction.prototype.getAttributeValue=function(e){var t=this.getData();for(var n=0;n<t.length;n++){if(t[n].getName()==e){return t[n]}}};t.ProcessingInstruction.prototype.setAttributeValue=function(e,n){var r=this.getData();if(e){if(typeof n=="undefined"){n=""}for(var i=0;i<r.length;i++){if(r[i].getName()==e){r[i].setValue(n);return}}r.push(new t.Attribute(e,n))}};t.ProcessingInstruction.prototype.clone=function(){var e=new t.Cloner;return e.cloneProcessingInstruction(this)};t.QName=function(e,n){this.dataType=t.constants.DATATYPE_QNAME;this.isSw8tXmlContent=false;this.prefix=t.Util.nothingToBlank(e);this.localPart=t.Util.nothingToBlank(n)};t.QName.prototype.getName=function(){var e="";if(t.Util.hasValue(this.prefix)){e+=this.prefix+":"}if(t.Util.hasValue(this.localPart)){e+=this.localPart}return e};t.QName.prototype.setName=function(e){var n=t.Util.nothingToBlank(e);var r=n.split(":");if(r.length>1){this.prefix=r[0];this.localPart=r[1]}else{this.prefix="";this.localPart=n}};t.QName.prototype.getPrefix=function(){return t.Util.nothingToBlank(this.prefix)};t.QName.prototype.setPrefix=function(e){this.prefix=t.Util.nothingToBlank(e)};t.QName.prototype.getLocalPart=function(){return t.Util.nothingToBlank(this.localPart)};t.QName.prototype.setLocalPart=function(e){this.localPart=t.Util.nothingToBlank(e)};t.QName.prototype.toString=function(){return this.getName()};t.QName.prototype.clone=function(){var e=new t.Cloner;return e.clone(this)};t.Text=function(e){this.dataType=t.constants.DATATYPE_TEXT;this.isSw8tXmlContent=true;this.text=t.Util.erefEncode(t.Util.nothingToBlank(e))};t.Text.prototype.getText=function(e){if(t.Util.isEmpty(e)){e=true}var n=t.Util.nothingToBlank(this.text);return e?t.Util.erefDecode(n):n};t.Text.prototype.setText=function(e){this.text=t.Util.erefEncode(t.Util.nothingToBlank(e))};t.Text.prototype.toString=function(){return this.getText()};t.Text.prototype.clone=function(){var e=new t.Cloner;return e.clone(this)};t.Token=function(e,n){this.dataType=t.constants.DATATYPE_TOKEN;this.isSwt8XmlContent=false;this.content=typeof e=="undefined"?new String:e;this.isLiteral=false;this.position=n?n:0};t.Token.prototype.getContent=function(){return this.content};t.Token.prototype.setContent=function(e){this.content=e};t.Token.prototype.getPosition=function(){return this.position};t.Token.prototype.setPosition=function(e){this.position=e};t.Token.prototype.hasValue=function(){try{return t.Util.hasValue(this.content)}catch(e){return false}};t.Token.prototype.isDOCTYPEStart=function(){return this.content==t.constants.DOCTYPE_START};t.Token.prototype.isPIStart=function(){return this.content==t.constants.PI_START};t.Token.prototype.isPIEnd=function(){return this.content==t.constants.PI_END};t.Token.prototype.isSelfTerminating=function(){return this.content==t.constants.TAG_CLOSE_SELF_TERMINATING};t.Token.prototype.isEndTag=function(){return this.content==t.constants.ENDTAG_OPEN};t.Token.prototype.isCommentStart=function(){return this.content==t.constants.COMMENT_START};t.Token.prototype.isCommentEnd=function(){return this.content==t.constants.COMMENT_END};t.Token.prototype.isAttribute=function(){return this.content==t.constants.EQUALS};t.Token.prototype.isCDATAStart=function(){return this.content==t.constants.CDATA_START};t.Token.prototype.isCDATAEnd=function(){return this.content==t.constants.CDATA_END};t.Token.prototype.isTagOpen=function(){return this.content==t.constants.TAG_OPEN};t.Token.prototype.isTagClose=function(){return this.content==t.constants.TAG_CLOSE};t.Token.prototype.isQuote=function(){return this.content==t.constants.SQUOTE||this.content==t.constants.DQUOTE};t.Token.prototype.isQuoted=function(){return this.content.charAt(0)=='"'&&this.content.charAt(this.content.length-1)=='"'};t.Token.prototype.getType=function(){if(this.isDOCTYPEStart()){return t.constants.TOKENTYPE_DOCTYPE_START}if(this.isPIStart()){return t.constants.TOKENTYPE_PI_START}if(this.isPIEnd()){return t.constants.TOKENTYPE_PI_END}if(this.isSelfTerminating()){return t.constants.TOKENTYPE_SELF_TERMINATING}if(this.isEndTag()){return t.constants.TOKENTYPE_ENDTAG_OPEN}if(this.isCommentStart()){return t.constants.TOKENTYPE_COMMENT_START}if(this.isCommentEnd()){return t.constants.TOKENTYPE_COMMENT_END}if(this.isAttribute()){return t.constants.TOKENTYPE_ATTRIBUTE}if(this.isCDATAStart()){return t.constants.TOKENTYPE_CDATA_START}if(this.isCDATAEnd()){return t.constants.TOKENTYPE_CDATA_END}if(this.isTagOpen()){return t.constants.TOKENTYPE_TAG_OPEN}if(this.isTagClose()){return t.constants.TOKENTYPE_TAG_CLOSE}if(this.isQuote()){return t.constants.TOKENTYPE_QUOTE}if(this.isQuoted()){return t.constants.TOKENTYPE_QUOTED}return t.constants.TOKENTYPE_NORMAL};t.Tokenizer=function(e){this.dataType=t.constants.DATATYPE_TOKENIZER;this.isSw8tXmlContent=false;this.setMarkup(e);this.tokens=new Array};t.Tokenizer.prototype.getMarkup=function(){return this.markup};t.Tokenizer.prototype.setMarkup=function(e){this.markup=e?e:""};t.Tokenizer.prototype.determineTokenType=function(e,n){var r=this.markup.charAt(e);var i=e>0?this.markup.charAt(e-1):null;if(t.Util.hasWhitespace(r)){return t.constants.TOKENTYPE_WHITESPACE}if(this.markup.slice(e,e+9)==t.constants.DOCTYPE_START){return t.constants.TOKENTYPE_DOCTYPE_START}if(this.markup.slice(e,e+9)==t.constants.CDATA_START){return t.constants.TOKENTYPE_CDATA_START}if(this.markup.slice(e,e+4)==t.constants.COMMENT_START){return t.constants.TOKENTYPE_COMMENT_START}if(this.markup.slice(e,e+3)==t.constants.CDATA_END){return t.constants.TOKENTYPE_CDATA_END}if(this.markup.slice(e,e+2)==t.constants.PI_START){return t.constants.TOKENTYPE_PI_START}if(this.markup.slice(e,e+2)==t.constants.PI_END){return t.constants.TOKENTYPE_PI_END}if(this.markup.slice(e,e+2)==t.constants.TAG_CLOSE_SELF_TERMINATING){return t.constants.TOKENTYPE_SELF_TERMINATING}if(this.markup.slice(e,e+2)==t.constants.ENDTAG_OPEN){return t.constants.TOKENTYPE_ENDTAG_OPEN}if(r==t.constants.EQUALS&&n){return t.constants.TOKENTYPE_ATTRIBUTE}if(r==t.constants.TAG_OPEN){return t.constants.TOKENTYPE_TAG_OPEN}if(r==t.constants.TAG_CLOSE){return t.constants.TOKENTYPE_TAG_CLOSE}if(r==t.constants.SQUOTE){return t.constants.TOKENTYPE_QUOTE}if(r==t.constants.DQUOTE){if(i!==null||i!="\\"){return t.constants.TOKENTYPE_QUOTE}}if(r==t.constants.BRACKET_OPEN){return t.constants.TOKENTYPE_BRACKET_OPEN}return t.constants.TOKENTYPE_NORMAL};t.Tokenizer.prototype.isQuote=function(e){return e==t.constants.SQUOTE||e==t.constants.DQUOTE};t.Tokenizer.prototype.toString=function(){var e=this.tokens;var t=new String;for(var n=0;n<e.length;n++){if(n>0){t+=","}t+=e[n].content}return t};t.Tokenizer.prototype.tokenizeTagContent=function(e,n){var r=false;var i,s;for(var o=n+1;o<this.markup.length;o++){if(this.markup.slice(o,o+9)==t.constants.CDATA_START){r=true;break}else{if(this.markup.charAt(o)==t.constants.TAG_OPEN){break}}}if(r){s=new t.Token(t.constants.CDATA_START,o);e.push(s);s=new t.Token("",o+9);s.isLiteral=true;i=t.constants.CDATA_END;for(n=o+9;n<this.markup.length;n++){if(this.markup.slice(n,n+3)==i){e.push(s);s=new t.Token(i,n);e.push(s);n+=2;s=new t.Token("",n+3);break}else{s.content+=this.markup.charAt(n)}}}else{s=new t.Token("",n+1);s.isLiteral=true}return{token:s,c:n}};t.Tokenizer.prototype.tokenize=function(){var e=new Array;this.tokens=e;var n=new t.Token;var r=false,i=false,s=false;var o,u,a,f;for(var l=0;l<this.markup.length;l++){var c=this.determineTokenType(l,r);switch(c){case t.constants.TOKENTYPE_DOCTYPE_START:i=true;if(n.hasValue()){e.push(n)}n=new t.Token(t.constants.DOCTYPE_START,l);l+=8;break;case t.constants.TOKENTYPE_BRACKET_OPEN:if(i){if(n.hasValue()){e.push(n)}n=new t.Token(this.markup.charAt(l),l);n.isLiteral=true;o=t.constants.BRACKET_CLOSE;for(++l;l<this.markup.length;l++){n.content+=this.markup.charAt(l);if(this.markup.charAt(l)==o){if(n.hasValue()){e.push(n)}n=new t.Token("",l+1);break}}}else{n.content+=this.markup.charAt(l)}break;case t.constants.TOKENTYPE_PI_START:var h;var p="";if(n.hasValue()){e.push(n)}n=new t.Token(t.constants.PI_START,l);e.push(n);u=l+2;r=true;for(l=u;l<this.markup.length;l++){h=this.determineTokenType(l,r);if(h==t.constants.TOKENTYPE_PI_END){p=this.markup.slice(u,l);if(t.Util.isUndefinedNullOrBlank(p)){p="xml"}n=new t.Token(p,l);e.push(n);n=new t.Token(t.constants.PI_END,l);e.push(n);r=false;break}else{if(h==t.constants.TOKENTYPE_WHITESPACE){if(p===""){p=this.markup.slice(u,l);if(t.Util.isUndefinedNullOrBlank(p)){p="xml"}n=new t.Token(p,l);e.push(n)}break}}}n=new t.Token("",l);break;case t.constants.TOKENTYPE_PI_END:n=new t.Token(t.constants.PI_END,l);e.push(n);r=false;l+=2;n=new t.Token("",l);break;case t.constants.TOKENTYPE_WHITESPACE:if(n.isLiteral){n.content+=this.markup.charAt(l);break}for(++l;l<this.markup.length;l++){if(t.Util.hasWhitespace(this.markup.charAt(l))){continue}else{if(n.hasValue()){e.push(n)}c=this.determineTokenType(l,r);if(c==t.constants.TOKENTYPE_NORMAL){a=this.markup.charAt(l);n=new t.Token(a,l)}else{l--;n=new t.Token("",l+1)}break}}break;case t.constants.TOKENTYPE_SELF_TERMINATING:case t.constants.TOKENTYPE_ENDTAG_OPEN:r=false;if(n.hasValue()){e.push(n)}n=new t.Token(this.markup.slice(l,l+2),l);if(n.hasValue()){e.push(n)}l++;n=new t.Token("",l+1);break;case t.constants.TOKENTYPE_TAG_CLOSE:r=false;i=false;if(n.hasValue()){e.push(n)}n=new t.Token(t.constants.TAG_CLOSE,l);e.push(n);var d=this.tokenizeTagContent(e,l);n=d.token;l=d.c;break;case t.constants.TOKENTYPE_ATTRIBUTE:case t.constants.TOKENTYPE_TAG_OPEN:if(this.markup.charAt(l)==t.constants.TAG_OPEN){r=true}if(n.hasValue()){e.push(n)}n=new t.Token(this.markup.charAt(l),l);if(n.hasValue()){e.push(n)}n=new t.Token("",l+1);break;case t.constants.TOKENTYPE_QUOTE:if(n.hasValue()){e.push(n)}n=new t.Token(this.markup.charAt(l),l);n.isLiteral=true;o=this.markup.charAt(l);for(++l;l<this.markup.length;l++){n.content+=this.markup.charAt(l);if(this.markup.charAt(l)==o){if(n.hasValue()){e.push(n)}n=new t.Token("",l+1);break}}break;case t.constants.TOKENTYPE_COMMENT_START:if(n.hasValue()){e.push(n)}n=new t.Token(t.constants.COMMENT_START,l);e.push(n);o=t.constants.COMMENT_END;u=l+4;for(l=u;l<this.markup.length;l++){if(this.markup.slice(l,l+3)==o){f=this.markup.slice(u,l);n=new t.Token(f,u);n.isLiteral=true;e.push(n);n=new t.Token(o,l);e.push(n);l=l+2;break}}n=new t.Token("",l);break;default:n.content+=this.markup.charAt(l);break}}if(n.hasValue()){e.push(n)}return e};t.Util=new Object;t.Util.hasWhitespace=function(e){if(typeof e=="undefined"||e===null){return false}var t=e+"";var n=new RegExp(/^\s+$/);for(var r=0;r<t.length;r++){var i=t.charAt(r);if(n.test(i)){return true}}return false};t.Util.isUndefinedNullOrBlank=function(e){return!t.Util.hasValue(e)};t.Util.isEmpty=t.Util.isUndefinedNullOrBlank;t.Util.nothingToBlank=function(e){return t.Util.isEmpty(e)?"":e};t.Util.isAllWhitespace=function(e){if(typeof e=="undefined"||e===null){return false}var n=e+"";for(var r=0;r<n.length;r++){var i=n.charAt(r);if(!t.Util.hasWhitespace(i)){return false}}return true};t.Util.hasValue=function(e){if(typeof e=="undefined"||e===null){return false}var n=e+"";return!(n.length===0||t.Util.isAllWhitespace(n))};t.Util.trim=function(e){var t=e+"";return t.replace(/^\s+|\s+$/g,"")};t.Util.leftTrim=function(e){var t=e+"";return t.replace(/^\s+/,"")};t.Util.rightTrim=function(e){var t=e+"";return t.replace(/\s+$/,"")};t.Util.splitByWhitespace=function(e){if(typeof e=="undefined"||e===null){return e}var n=t.Util.trim(e)+"";return n.split(/\s+/)};t.Util.removeArrayItem=function(e,t){try{for(var n=0;n<e.length;n++){if(n==t){e.splice(n,1)}}}catch(r){}return e};t.Util.dataType=function(e){return typeof e!="undefined"&&e!==null&&e.dataType&&typeof e.dataType=="string"&&e.dataType.length>9&&e.dataType.slice(0,9)=="marknote."?e.dataType:typeof e};t.Util.replaceAll=function(e,t,n){var r=e+"";var i=0;var s="";while(r.indexOf(t,i)!=-1){s+=r.substring(i,r.indexOf(t,i));s+=n;i=r.indexOf(t,i)+t.length}s+=e.substring(i,e.length);return s};t.Util.erefEncode=function(e){var n=e+"";return t.Util.erefTransform(n,true)};t.Util.erefXMLEncode=function(e){var n=e+"";return t.Util.erefTransform(n,true,true)};t.Util.erefDecode=function(e){var n=e+"";return t.Util.erefTransform(n,false)};t.Util.erefXMLDecode=function(e){var n=e+"";return t.Util.erefTransform(n,false,true)};t.Util.erefTransform=function(e,n,r){var i=r?(new t.XMLEntityRefs).getRefs():(new t.EntityRefs).getRefs();var s=new String;s+=e;for(var o=0;o<i.length;o++){var u="&"+i[o].name+";";var a=i[o].character;var f=n?a:u;var l=n?u:a;s=t.Util.replaceAll(s,f,l)}return t.Util.replaceAll(s,"&quot;",'"')};t.Writer=function(){this.dataType=t.constants.DATATYPE_WRITER;this.isSw8tXmlContent=false};t.Writer.prototype.outputDocument=function(e,n){var r=new String;var i=e.getProcessingInstructions();var s=e.getDOCTYPE();for(var o=0;o<i.length;o++){if(o>0){r+="\n"}r+=t.constants.PI_START;var u=i[o];r+=u.getTarget();var a=u.getData();for(var f=0;f<a.length;f++){var l=a[f];r+=" "+l.getName()+'="'+l.getValue()+'"'}r+=" "+t.constants.PI_END}if(s){r+="\n"+s.toString()}var c=e.getRootElement();r+=this.outputElement(c,0,n);return r};t.Writer.prototype.outputElement=function(e,n,r){var i,s,o;i="\n"+this.calculateIndent(n,r)+t.constants.TAG_OPEN+e.getName();for(var u=0;u<e.getAttributes().length;u++){var a=e.getAttributeAt(u);i+=" "+a.getName()+t.constants.EQUALS+t.constants.DQUOTE+a.getValue(false)+t.constants.DQUOTE}if(e.isSelfTerminated||!e.hasContents()){i+=" "+t.constants.TAG_CLOSE_SELF_TERMINATING;return i}i+=t.constants.TAG_CLOSE;if(n===0){n=1}s=this.outputContents(e,n,r);o=e.contents.length==1&&e.getText().length>0&&this.hasStrictText(e)?"":this.calculateIndent(n,r);var f=o+t.constants.ENDTAG_OPEN+e.getName()+t.constants.TAG_CLOSE;return i+s+f};t.Writer.prototype.hasStrictText=function(e){var n=true;for(var r=0;r<e.contents.length;r++){var i=e.getContentAt(r);var s=t.Util.dataType(i);if(s!=t.constants.DATATYPE_TEXT){return false}}return n};t.Writer.prototype.calculateIndent=function(e,n){if(e===0){return""}var r="";n=n&&t.Util.isAllWhitespace(n)?n:"    ";for(var i=1;i<e;i++){r+=n}return r};t.Writer.prototype.outputContents=function(e,n,r){var i=this.calculateIndent(n+1,r);var s=this.calculateIndent(n+2,r);var o=new String;var u="";var a,f,l;for(var c=0;c<e.getContents().length;c++){var h=e.getContentAt(c);u=t.Util.dataType(h);switch(u){case t.constants.DATATYPE_COMMENT:o+="\n"+i+t.constants.COMMENT_START;f=h.getText();l=f.split("\n");for(a=0;a<l.length;a++){o+="\n"+s+t.Util.leftTrim(l[a])}o+="\n"+i+t.constants.COMMENT_END;break;case t.constants.DATATYPE_ELEMENT:o+=this.outputElement(h,n+1,r);break;case t.constants.DATATYPE_TEXT:o+=h.getText(false);break;case t.constants.DATATYPE_CDATA:o+="\n"+i+t.constants.CDATA_START+"\n"+s+h.getText()+"\n"+i+t.constants.CDATA_END;break}}if(u!=t.constants.DATATYPE_TEXT){o+="\n"}return o};n=(new t.Parser).parse(e.data.data);u=n.getRootElement().getChildElements("trk");for(o=u.length;s<o;s++){i=u[s];f=i.getChildElements("trkseg");for(c=f.length;l<c;l++){r=f[l].getChildElements("trkpt");p=r.length;for(;h<p;h++){d=r[h].getAttribute("lat").getValue();v=r[h].getAttribute("lon").getValue();m.push({latitude:d,longitude:v})}}}self.postMessage(m);self.close()};try{r=new Blob(["self.addEventListener('message', ",f.valueOf(),", false);"])}catch(c){r=new s;r.append("self.addEventListener('message', ");r.append(f.valueOf());r.append(", false);");r=r.getBlob()}l.onload=function(e){u=new Worker(i.createObjectURL(r));u.postMessage({data:e.target.result});u.addEventListener("message",function(e){var t=e.data;if(t&&t.length&&t.length>0){console.log("mapController",mapController);mapController.mapSetup({editMode:true,points:t});o("Map successfully edited.")}else{o("No point found in your gpx file. Map not edited.")}},false)};t.innerHTML="Reading the file...";l.readAsText(n[0])}function f(e){e.stopPropagation();e.preventDefault();e.dataTransfer.dropEffect="copy"}window.type={none:0};var t=document.createElement("div");t.innerHTML="Drop the gpx race file here.";t.setAttribute("style","font: bold 0.8em Arial; width:13em; padding: 14.5em 0 1em 0; background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIEAAACWCAIAAAB2EXwkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAFLlJREFUeNrsXQlsHNd5nmtP7kFyeUkiJVq2pZaWLEt1bEFWY6dGmjRpIdSAY8tV3SNJ6/QI4B4obLhxYcMOUDRxggZw0ThIYihJ3SKKauc04qOVlNSBK6uyTlsWFZGSeJjL5bH3zky/2X/59DSzF/dech6Wg+HMm+v/3v/9x5t5TwyHw4JdmlokWwQ2BnaxMbAxsIuNgY2BXWwMbAzsYmNgY2AXVpTlHqDrOpZatujZ0iJPwt8Jvy5JRjsTRVHKFqzQdrbSZhjg2SD6TLakUiksCYlGyrfkLn6LmC09PT24W6wo2dI60q9QD1RVxfNgJRAIAIPm6gFaQDn6Crl3dnaOj4+n02mXy+VwOKAQqNAiYCxbD4BBLBbDY6BxNZ5kSmoGjwrWk9kCDJxO5+Dg4NjYGG7e6/Xi/klF2s8m48nRlKLRKJ6kiQAUIkkCgKwUcSZUdnFxcX5+Htsh9w0bNmC5sLAAYNCYGkOktceAuAjP0CLmN+8uwgDNBW0FGMzNzTGzPDAw4Ha7sQV78SytgMGy7QG1r/JbaAPEbfqXCkSMhhKPxwED3TD5SOAlwDAzMxMOh4PBIDiK+U5tg0FxS9hgIuIB4Ndxh2jjBAO0FuSJLSRoLGVZ7u7uxnJ2dhbbYaUBTBNhaNcYzSR00zoBQN4zrSQSCXasnC1+vz8UCgEe6ArqNKxhtRMGxZXAREEmy0wRDFldgoHHgGBA24eD1NfXh10MhqaYB6lNlcBqEpglYKKn8IXWTY4c7DPB4PF4AAMoC6Yb6tIUGJQ6tdN6C93U/EnWFEJSwyefhyJ5FKszTfYZdWCWAcPU1BR8Vp/Ph3/5lIatB+UaBqtBNmW0wPt5Hj4LAwqCBsAAuQMGaEODfVapfcVtdU81S2G7wPj5n38JBpSuri4sETpQBNcwGKS2EH3JvXx2iImeHYgGbrLJvGEgb5W0Ac4SlpFIBJg1LBumtIXQrWaArTPlYB4RYcCIiEqR5AqpAuMxwIAt0AaoAiw2JfhWFwaFml7evgqrY2qFihp78QQXqQJDDj4rlvPz87Re7wSf0qZcZFIIvpgqkJMDii+erCYMyFNCgQZgCRMNVOAsUSBdJxjaAINyQmXGP3lxgnwhQZgESLbICQkGxmxUGXEDwQBtQIV6wNBa8UERS8D/y3MOLzWrGWB6gCXMbHEMKHDjzQxdCNoA2xAIBBA61AOGNtaDQg5rXsmSHpR2E5cCNyyZl9XR0QFtgLXv7OykBF9tYVDaUehWjSkEA+vHx7LMPg8GA68QsMxQo5mZGcBAzlINYVBWsBKwNyooUVqOHlhh4GMOOFfhcBihHIOhJkhUiEGdclvW1l0oN5fXKlhRYa+0AIPy+/5Y4GayNG63GzCQNtTQWVLaVwOKC5EKI6LyuShv4MYvQUrT09MUzVEEVyUMSltLP68zShJhGDA9KJ+L8gZuPDVBG6ampuAsBYPB6n3WFvJNy+k6zks4JZ0iFNYNvqxiCtx42wBtAAxYBwxwlqqBQWlrzinCQiYigowqwMAauJmWk5OTWOnu7oapWLEYVAAAT0QUGYAuWCcz1pd7TpwErT4SiVDvEPXQQfSObJmdnaWcUsWpPaX1xcr8n+WyOYMBZ8ASYjpz5gy2UA8PZMre9FKzhfjq8uXLbAvTAD7FjYJWDwrq7+8fGhqCKoRCIcRxKyRXUdIxNWUR8mbrTC4m4yJUAINTXz91dlLHJwOAlpSt4y9hOhWwBAaBQAB+EVbo9Rkcu3pzFbzE+VwpvVBEBpnPmDJrQRLncxJ54x5WnyHhdDohfdiAnp4erFTfHJUVJn1TcEDN1kTukDtr+Czc47WNBdhWMwsAwP4IlRGmkRlg9rnRGDTAMS30BpG1Ny3vzZD4mHPJckdW38Z6dQYqrTCTgPOA9yF9YiHmj666GK2IsKjtk0wp0AXvk6SoAjV8/n0LU+RB0uRzISwMJDMAAAADAWDn7PI3fEb99JUHBAerS9gAANpogsGaeaV1qkz+FSQO5kHzxxIRWavkrmtLR8X7igXLy3RCvnw1204eLTEP+aa0wg5nYDBjQApk+oKBoAWQcJZ8Ph+W9J62yQLZemCmJtZ+eXYiVExAMqLPa3XoKHofEs0f/FOndyxWFAZWO0EUxDwlgoG3tCwzyuOXE81SOAYDgObPvx9f22/Z2oCLCnlBheIyZkVpnbcTxE4mIZqiB3ZaAoC6a5gFLtTDsYr0wBoK5IWBWjQBwMRK/1JLZ0lpU1aO8CAjDNtL/MM8qzo9lNK+crdu55NFJGgWADPp8wcyJHioyAaAfCgjXdIAVK8KrctFeR0eq4NU5LV43uU3nY3FVuQ+8RpA2VB6jYU3ACakbb9I4OMyU+vmV/LKnceJURZVoPQqAGDdDw14EKV9hZ7XHlgjZ94xtdpeFhkQNQEAen2okZ8ItvR3OHkpqHjuqMgZ8hoYPiEK6fPm14plEX6z80WClXlY4tOkNPwu3oYT+/PNv2GDKSitowTFQ4QyX6zL+6FOXt+JB8MKgDUQq5/erxybXNwsF4ok+Jch8yYBGQCswkp+57e4gRUsAxMxAKw9aEWas2nd5P/w5iEvHlYAmvmeXePpKK81tjJPoaSm1a7y/ZQ8YCY7XG8HRGlTFuJFZjLLhXJBfLW8ABSxw4X6y5r5zm/jCSovU1lhsHqTVoeS76MvJOhC9LXy44Nyhuwq2Zlspa8yhWg1MNZAweai/BRRRD9KspmVhRo/8GNLf39QTuRcvIWa4rLyVcE66GChJPlK04OST2U1tsWtRTnhrskMsFCg0FE11w+pNemlgvqVpRas/NP4wR7bY+wcodSLF0W+7i8H3eJ+VL0fvG1scpEoupBxLqlV1vC4wda4RbmoTJoq4uCXcx6ec5o+0mzr6kE59FLO51BFzmDyYsuJA1prrISWig8KcVGZprgezsLKscnlaEPFrm2R/p+SkaCtB6WTo+V7tM1q/m1jk4vnG6oUUEmvqdXfq2hYfFDOhZZrCUoeVb8MXVtyUTniKP7qVYvY3va2B+W3yrqyU2th0JTZiOp9xUbyT7v6RfXzEZsbKrdNzq6tNay9fdPVUGwMbAzsUj+bbB3NYyXZD77QgDo04ws/ck/e95cahAGbjGMuoyyKHRnRqYryCm7FG+66H41rwnjy7E8QZF116GmfEAsqmXK+ZatxfMCmgHgn6hlXgxcXhPPzwlxST2urhVgckhB0SRsDrvV+15Ayv6kjXnL4R6XmSgAALiwIr4cDEzHtcnTVkXtSE6YywlRUuDgvDHj9bi2x3p8pPiZtLeMDmn8mmUz+53goJuqXF1aoBSivXF4QHKJwcNz7mRsipAeFYFBqqwQgIpimd8Ka062qmrDKy3RMGE/oEAgNc9QgDMhJWEykXJJL01c7BotJIRlP0jCENIZS3bmIBoYzJntTtbS66hEQBBABRFFypu8a2+TcyHDgoSrG2LMQHCBNampa0DVRkiXFKTpcoihZq+lqOn//AegYR4nsg29Nz6RRf2mvLCqOa05onCwN+eXetLBWKF8gSwMWNggDFovhmmL1009CEJlUJhpxpSO3Dihr/bhVUKr85njs3IzT4euS3T5Rzt2/rmbc6chGT1RL5RlQWRQdRy+rDl83DgGEkO9G96Ins6ClExBwVHOMLgSVjmBOyrj/ZKxHC/e7Uzit5HDHFf/5hHFgBQ+hFhiurY7xQW6cOFy5OotsnCMRdS5e+ezOznt3fcC0d2x67huHzv/w4rwz2EeigScw7Fr8yt6bC51wLpr47v+c//bJSMrbL8pyJhH7yoNb2d59//qLi3GH7PIap8oklfnLz+y7cagnQHv/4PlTmuoVRK0iPSg9OGvt80WkB1k2qvSXUVOLc0PqpQN/evO9uzZZLzHUG/z7e7Y//AFnInwlk06pWc5VU/EidxXscP/x3SNf3jMI+app9WxEfualY2zvn+1ek5idME4F33ouvPcmFwMA1VBZF6QKn6WMjwTqki/Sq7MHWirenbzy7J/sgODYxhOjE3Ox5FBvYH1fF235xB2bxsPHXnhvxuEL4XK6fPVRL06Ex2YWDG7R9YDXueW6Adp+04beh26b/cKbc0pH5/63Ix/eOrVluA/bd40MfezE5I+vRESHc1iZ+dSHd+cuemFq/9tJd2+/Zjh5amWiaE7OzggNKuYiXUtGph/dM8QAOHLy4pPfPzeZ6RAlRUuNfWi98A/3/lrQZ8wu9Fe/c8tPv3hkJuXD5XTOF37h8Nn9J1KKJ5CdUTyxPXT6mQd30iGf2L3p6VcOS55O2d/7xItn//2zfXTIwx/f8tMvvbGYFh/7w83sPKgg+9dpulTx45QTJUl1wkCttKQT0e2hFBomnert0Ym//d75993rHV2DSucaR8+G16d8X3jpOLvW3Tf6Qe7GBfWrTysqLtnXIwf6leCAI7T+6GzHD998j+29dZ0jnUwIsvPdeOCfDv4vI6t92zwPjMhbhvtpC3ahAqqpVRWtOXoAgYiVclEmvnjb5qszaD336rm4q1eWnOzLb8kTPPjuxEdPX4YnKsBrlI1dYtYfuNZT5fhQco7NXE1dwXpoGRyrSJ7AN98a+8i2ya3XGXJ/6Ldvm1uILWE/+c23os7QUMUsxERRRwyKDJJigJ+pUHnT8diuTRvZvy+/G3f1rUUjB0fBVzWcerR3xfvp74zCgYHnLrt8sidgiJXjItRVM5qIe9CzHu5i5KZ1a9jeSNxATTfuUJK8PY9/9+SBv8m1/aDfSyvYKHkHNE0SqnOym6YHxiDoFetBMr51Y86EHjo+qsvZnAdAyKTWOBbXdCSN5o9ijPUtIfha0NR3FpPCtfOyqMloYnpWmp8GBn6Hev+24Md35lj+l5Ozp6ZVZ7eYu0PZeXre/fkXjjxy3x3scPyLjY6AU6060lSbZZO1KjBQ1QwfXAEAegwtGbt7k/x3v3uHqf7hk+Of/LeLksvH68EjD9z5yAP5z/+dw+8JTp/KGEbPjjyuide6BYYqwxsVRL0GohDEhnJRrhMto+mVcpGm8rJASJuRsqeCU6+pUr76iAxSugymKn3Fb7168qtvLCiBfnXp9rRUbFNH/NG9v8lXe3Tv7p89/fI78Zjk9FaLgXEhuTlcpFeqB5oo/d+5y9tuWIv1D27bmHnuhJROwfbqonxiKv30f7xpWIV0fN9vbB1e28OikexfsTb70s/P/ODY5E/eU2UEE1lyIx3IRCae+stbrPWfum/rnn8+pnQNwuRUrQdNwUDTKsZAl5zHL7xPGKB8ZLP35UuLoBpBlH92ST1yEfYgkw6P/cWe25eUD5dTjZwApwdPPv/KvxyekpxL86NIsuRwi64OqcOjwR1Xl1goNvvp24Pbrs+Z6+d/9IsNA113br8R69j4qdtHv3p0RvZ2CWLlHrymNTM+qPAHI/zSWxPsVH/+0ZHU7BUYaiMIk5y64kWdB3YOdfq9VxmLDuT7KxSPFFgndW3I/YKDgrdHlz1G7Lh0IUQVm33Rx/buyjlLi/GnfjD61PdOsXNgFyoYwYdaVeqlXhjoRYuWUSv+6YJyaDT1X8fO04WgEM/u+5WB9KXU+2Pp8KXU1OjO0MJj99/O3YrBucaxfIsreQ+pVHpu8h9/bzs74q+/dmhR6TsR8T6x/xDbiAqohsrVPFHT/CK9Gq/OFXjywCmwQaffCNb27B7B7/Wj5+AmDQ90Dq8JWVKExuV4PchNN1HoHmC+Y5HP7A7dssR4Bw+f+v7phOwPQqf2vzH14N3h4TXd2I4KD+0OPfvzsOTtrIyRypFDy3GR0eEhOo7PuO/5/E8iC1dToXftuOGu7dczAJ759iumy2lcrkIrmrsFs410Jh7f9+s5FlqIPXngjO7qBG3AWkR0/8PPHWGnQrWRYCzLSGpbcVG1IOi64j4+6/3Q53709R8ftV798ecPPfHi6LFzV7JP4NAF2dAB+WqSVZRdui4WPH86+bn7drDKXzr41oWoG34X5ZphkP77gnrwyFlW4YufvMOvVP44JYUphsPhZQSxmczc3NylS5fS6fTIyIg5zZBOx2KxSCTysW/Mi86OqtVJR2ysp6JBKXbX5s4NvYYRnotlDh6dmkeULDv1VEzIJASHR3L5Dec1HdcTC7qaFGUHri46fUIht1JNa8kFIRWDtuSvTBXSMSM1Ikqi4VMFRKOzaNmfKeD+X32ojyaRojlEGmYPNLEmb7aIDsEVnNP8B8+mhNMLhv2VFFHuxdIQh9uVuxz9yR6hwyPm7LThsxZOOMuCqxO/wpWvqZCroy69y7g8e9CsfFFN+pM5KATZZfw4vq9AHE0p5UTvtc9VZAP0tChlhGaPxdECCBh5m5KvXtdYD+h6bjETTycFxbXaMcgkXUJKKPW9m1JzALAc8sZOv58Qfb0VGLEVpQWx8PX9YsnxSWqvB7Is//6tHY8e+KUGT8PdtXohSMyKsek/2rmJBjRvEAZsFoEd13Xdf/Pkt44cF/zrRN+A4HALK/ozEJMnJKQT+uKEsHDpwTuHd2zsbuj3BzSbD80rufeD113f63jxyJnzY8fmYqlVpQDBDtcNazvv+a0tO29aTzNL0dwiDcKApjNBPIK4/rZfHdw6HEqlUnUaDLVFyunTp/v7+7u6uiBuJgSEYx6Px+/30/x2jeYiXJLNfEXTbLMJslZkgZQDgUAwGITQhaUZgl3Zgl1sirsGfYeTy0BlYaDmAAz4N79XpDYAAChBKBSC9gvcNNkQPWCgCR8b55syVWDGmV775iemX3nF5/OBc6AHwIBNG0xzyNNKvb7LLA4Dm18DMFQ29GIbFTR2mliWYdD875N5JFaDF0S0QzPbVXYGe6yEFkCxYoOs6/YXZ7Upy9YDsvtsPmG7lAyDa68HFIDYomeFIoDGYUBKgKvOz8+/9tprMzMz0WgUEcAqFD0aIiKD3t7ewcFBioQbhAGuBMwR/vX09GAFS4TBaq0+g203CkJbRHCAAA0r1ZBzJVyESwIMxMCpVIqisNVoSLPNkfJCWGmcHhAXsTwEJSFWp4PE4tCS3QO11wPbL2q+b2oXGwMbA7vYGNgY2MXGwMbALjYGNgZ2sTGwMbCLjYGNgV3qWv5fgAEAZ3EV/EUnHxMAAAAASUVORK5CYII=') #EAEAEA no-repeat; position: fixed; top: 1em; left: 1em; z-index: 99999; text-align: center;");t.addEventListener("dragover",f,false);t.addEventListener("drop",a,false);document.body.appendChild(t);var n=document.createElement("div"),r="draggable"in n||"ondragstart"in n&&"ondrop"in n,i=window.URL||window.webkitURL,s,o=function(e){t.innerHTML=e||"";setTimeout(function(){t.parentElement.removeChild(t)},2e3)};try{s=!!(new Blob)}catch(u){s=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder}if(!(r&&i&&s&&Worker&&FileReader)){o("You need a more recent browser");return}if(!window.mapController){o("Either you're not on RK race edition page, or RK made modifications to the code.");return}})();}

          document.getElementById("bk").href = "javascript:(" + bk.valueOf() + "());";
        </script>

<h3>Testimonials</h3>

<ul>
  <li>Amazing! Works like a sharm! &mdash; <a href="http://support.runkeeper.com/discussions/questions/2878-create-new-race-map-from-activityroute#comment_17209020">Bjornar</a>&nbsp;<ins datetime="2012-08-03">(link broken since last Runkeeper support platform migration)</ins></li>
  <li><ins datetime="2012-08-03">this is phenomenal! I was trying to create a 5.7 mile trail race and it was impossible to get it all correct. Your bookmarklet worked like a champ! Thanks! &mdash; <a href="http://support.runkeeper.com/entries/21704641-editing-a-race-s-map-using-a-gpx-file?page=1#post_21712432">Hollis</a></ins></li>
  <li><ins datetime="2012-09-18">Love the rkrace-bookmarklet! Great for creating race map (!) &mdash; <a href="https://twitter.com/HeatherUrry/status/244604352529043456">@HeatherUrry</a></ins></li>
  <li><ins datetime="2012-09-22">Thanks Valentin. This is super helpful for everyone. Throwing this up on the support home page for everyone to see! &mdash; <a href="http://support.runkeeper.com/entries/21704641-editing-a-race-s-map-using-a-gpx-file?page=1#post_21970628">Chas Wagner (from RunKeeper crew)</a>
  <li><ins datetime="2012-10-02">Awesome work by @jacqueminv in creating a GPX file import bookmarklet for RunKeeper race maps! &mdash; <a href="https://twitter.com/RunKeeper/status/249269548388347904">@RunKeeper</a></ins></li>
  <li><ins datetime="2013-02-14">That tool is really useful, thanks heaps! &mdash; <a href="https://twitter.com/felixmeister/status/301979221981548544">@felixmeister</a></ins></li>
</ul>

<h3>Support or Contact</h3>

<p>Having trouble? Ping me directly on twitter (<a href="https://twitter.com/jacqueminv">@jacqueminv</a>) or fill an <a href="https://github.com/jacqueminv/rkrace-bookmarklet/issues">issue on github</a>.</p>
      </section>
      <footer>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>

    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-38498129-1']);
      _gaq.push(['_setDomainName', 'github.com']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>

  </body>
</html>
